
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Downloader GUI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow-x: auto;
        }
        h1, h2 {
            color: #333;
        }
        .dependencies {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>YouTube Downloader GUI</h1>
    <h2>Dependencies</h2>
    <div class="dependencies">
        <ul>
            <li><strong>Python Version:</strong> 3.8 or above</li>
            <li><strong>Required Libraries:</strong></li>
            <ul>
                <li>yt-dlp >= 2023.01.06</li>
                <li>pydub >= 0.25.1</li>
                <li>tkinter (default library with Python)</li>
                <li>threading (default library with Python)</li>
            </ul>
            <li><strong>Installation Commands:</strong></li>
            <pre>
# Step 1: Download and install Python
# Download the latest Python installer from https://www.python.org/
# Make sure to check the box to add Python to PATH during installation.

# Step 2: Create a virtual environment (optional but recommended)
python -m venv myenv
# Activate the virtual environment:
# On Windows:
myenv\Scripts\activate
# On Linux/macOS:
source myenv/bin/activate

# Step 3: Upgrade pip
pip install --upgrade pip

# Step 4: Install required libraries
pip install yt-dlp
pip install pydub
            </pre>
        </ul>
    </div>
    <h2>Source Code</h2>
    <pre>

import tkinter as tk
from tkinter import messagebox
from tkinter import filedialog
import threading
import os
import logging
import yt_dlp

# 設置日誌
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

def download_youtube_mp3_and_subtitles(url, output_path="downloads/%(title)s.%(ext)s"):
    """從 YouTube 下載 MP3 和字幕"""
    try:
        ydl_opts = {
            'format': 'bestaudio/best',
            'postprocessors': [{
                'key': 'FFmpegExtractAudio',
                'preferredcodec': 'mp3',
                'preferredquality': '192',
            }],
            'outtmpl': output_path,
            'writesubtitles': True,
            'writeautomaticsub': True,
            'subtitleslangs': ['zh-Hant', 'zh-Hans', 'en'],
            'subtitlesformat': 'vtt',
        }

        with yt_dlp.YoutubeDL(ydl_opts) as ydl:
            logging.info(f"開始下載 {url}")
            info = ydl.extract_info(url, download=True)
            filename = ydl.prepare_filename(info)
            mp3_filename = os.path.splitext(filename)[0] + '.mp3'
            subtitle_files = [
                os.path.splitext(filename)[0] + '.zh-Hant.vtt',
                os.path.splitext(filename)[0] + '.zh-Hans.vtt',
                os.path.splitext(filename)[0] + '.en.vtt',
            ]

            subtitle_file = next((file for file in subtitle_files if os.path.exists(file)), None)

            if subtitle_file:
                logging.info(f"字幕文件已下載: {subtitle_file}")
            else:
                logging.warning("未找到字幕文件。")

            return mp3_filename, subtitle_file
    except Exception as e:
        logging.error(f"下載失敗：{str(e)}")
        return None, None

def start_download(url_entry, output_label):
    url = url_entry.get().strip()
    if not url:
        messagebox.showerror("錯誤", "請輸入有效的 YouTube 連結！")
        return

    def run_download():
        output_label.config(text="正在下載...")
        mp3_file, subtitle_file = download_youtube_mp3_and_subtitles(url)
        if mp3_file:
            output_text = f"音頻已下載至: {mp3_file}\n"
            if subtitle_file:
                output_text += f"字幕已下載至: {subtitle_file}"
            else:
                output_text += "未找到字幕文件。"
            output_label.config(text=output_text)
        else:
            output_label.config(text="下載失敗，請檢查連結或網絡。")
        messagebox.showinfo("完成", "下載已完成！")

    threading.Thread(target=run_download).start()

def create_gui():
    root = tk.Tk()
    root.title("YouTube MP3 &amp; 字幕下載器")
    root.geometry("500x300")
    root.resizable(False, False)

    tk.Label(root, text="請輸入 YouTube 影片 URL:").pack(pady=10)

    url_entry = tk.Entry(root, width=50)
    url_entry.pack(pady=5)

    output_label = tk.Label(root, text="", fg="green", wraplength=400, justify="left")
    output_label.pack(pady=10)

    download_button = tk.Button(root, text="開始下載", command=lambda: start_download(url_entry, output_label))
    download_button.pack(pady=5)

    root.mainloop()

if __name__ == "__main__":
    create_gui()
</pre>
</body>
</html>